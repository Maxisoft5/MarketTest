{"ast":null,"code":"import { Subject, takeUntil } from \"rxjs\";\nimport { SessionStorageConstanst } from \"src/app/shared/constanst/session-storage-constans\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/shared/services/session-storage-service\";\nimport * as i2 from \"src/app/shared/services/products-service\";\nimport * as i3 from \"@angular/router\";\nimport * as i4 from \"@angular/common\";\nimport * as i5 from \"@angular/cdk/overlay\";\nimport * as i6 from \"@nebular/theme\";\nfunction BusketComponent_ng_template_5_div_6_a_11_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"a\");\n    i0.ɵɵelement(1, \"br\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const prop_r5 = ctx.$implicit;\n    const ctx_r4 = i0.ɵɵnextContext(3);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r4.getFormattedProperty(prop_r5), \" \");\n  }\n}\nfunction BusketComponent_ng_template_5_div_6_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r7 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 11)(1, \"nb-card\")(2, \"nb-card-header\")(3, \"div\", 12)(4, \"a\");\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(6, \"br\");\n    i0.ɵɵelementStart(7, \"a\");\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(9, \"nb-card-body\")(10, \"div\", 13);\n    i0.ɵɵtemplate(11, BusketComponent_ng_template_5_div_6_a_11_Template, 3, 1, \"a\", 14);\n    i0.ɵɵpipe(12, \"keyvalue\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelement(13, \"nb-card-footer\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(14, \"a\", 15);\n    i0.ɵɵlistener(\"click\", function BusketComponent_ng_template_5_div_6_Template_a_click_14_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r7);\n      const product_r3 = restoredCtx.$implicit;\n      const ctx_r6 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r6.onDeleteProduct(product_r3.id));\n    });\n    i0.ɵɵtext(15, \" \\u0423\\u0434\\u0430\\u043B\\u0438\\u0442\\u044C \");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const product_r3 = ctx.$implicit;\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate1(\" \", product_r3.name, \" \");\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\"\\u0421\\u0442\\u043E\\u0438\\u043C\\u043E\\u0441\\u0442\\u044C: \", product_r3.price, \"\");\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpipeBind1(12, 3, product_r3.properties));\n  }\n}\nconst _c0 = function (a0) {\n  return [a0];\n};\nfunction BusketComponent_ng_template_5_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r9 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 5)(1, \"div\", 6)(2, \"button\", 7);\n    i0.ɵɵlistener(\"click\", function BusketComponent_ng_template_5_Template_button_click_2_listener() {\n      i0.ɵɵrestoreView(_r9);\n      const ctx_r8 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r8.clearBusket());\n    });\n    i0.ɵɵtext(3, \"\\u041E\\u0447\\u0438\\u0441\\u0442\\u0438\\u0442\\u044C \\u043A\\u043E\\u0440\\u0437\\u0438\\u043D\\u0443\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"button\", 8);\n    i0.ɵɵlistener(\"click\", function BusketComponent_ng_template_5_Template_button_click_4_listener() {\n      i0.ɵɵrestoreView(_r9);\n      const ctx_r10 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r10.isOpen = false);\n    });\n    i0.ɵɵtext(5, \"\\u041E\\u0444\\u043E\\u0440\\u043C\\u0438\\u0442\\u044C \\u0437\\u0430\\u043A\\u0430\\u0437\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵtemplate(6, BusketComponent_ng_template_5_div_6_Template, 16, 5, \"div\", 9);\n    i0.ɵɵelementStart(7, \"i\", 10);\n    i0.ɵɵlistener(\"click\", function BusketComponent_ng_template_5_Template_i_click_7_listener() {\n      i0.ɵɵrestoreView(_r9);\n      const ctx_r11 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r11.isOpen = false);\n    });\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"disabled\", ctx_r1.products.length == 0);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"disabled\", ctx_r1.products.length == 0)(\"routerLink\", i0.ɵɵpureFunction1(4, _c0, ctx_r1.routeOrderLine));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r1.products);\n  }\n}\nexport class BusketComponent {\n  constructor(sessionStorageService, productsService) {\n    this.sessionStorageService = sessionStorageService;\n    this.productsService = productsService;\n    this.isOpen = false;\n    this.products = [];\n    this.componentDestroyed$ = new Subject();\n    this.routeOrderLine = `/order/${this.generateUUID()}`;\n  }\n  ngOnDestroy() {\n    this.componentDestroyed$.next(true);\n    this.componentDestroyed$.complete();\n  }\n  ngOnInit() {\n    let products = this.sessionStorageService.getItemByKey(SessionStorageConstanst.Busket);\n    if (products) {\n      this.products = products;\n    }\n    this.productsService.bucketChanged.pipe(takeUntil(this.componentDestroyed$)).subscribe(() => {\n      console.log(\"test1\");\n      let products = this.sessionStorageService.getItemByKey(SessionStorageConstanst.Busket);\n      if (products) {\n        this.products = products;\n      }\n    });\n  }\n  getFormattedProperty(prop) {\n    return this.productsService.getFormattedProperty(prop);\n  }\n  openBusket() {\n    let products = this.sessionStorageService.getItemByKey(SessionStorageConstanst.Busket);\n    if (products) {\n      this.products = products;\n    }\n    this.isOpen = !this.isOpen;\n  }\n  clearBusket() {\n    this.products = [];\n    this.sessionStorageService.setItemInJSON(SessionStorageConstanst.Busket, this.products);\n  }\n  onDeleteProduct(id) {\n    this.products = this.products.filter(x => x.id != id);\n    this.sessionStorageService.setItemInJSON(SessionStorageConstanst.Busket, this.products);\n  }\n  generateUUID() {\n    var d = new Date().getTime();\n    var d2 = typeof performance !== 'undefined' && performance.now && performance.now() * 1000 || 0; //Time in microseconds since page-load or 0 if unsupported\n    return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\n      var r = Math.random() * 16;\n      if (d > 0) {\n        r = (d + r) % 16 | 0;\n        d = Math.floor(d / 16);\n      } else {\n        r = (d2 + r) % 16 | 0;\n        d2 = Math.floor(d2 / 16);\n      }\n      return (c === 'x' ? r : r & 0x3 | 0x8).toString(16);\n    });\n  }\n}\nBusketComponent.ɵfac = function BusketComponent_Factory(t) {\n  return new (t || BusketComponent)(i0.ɵɵdirectiveInject(i1.SessionStorageService), i0.ɵɵdirectiveInject(i2.ProductsService));\n};\nBusketComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: BusketComponent,\n  selectors: [[\"app-busket\"]],\n  decls: 6,\n  vars: 3,\n  consts: [[\"cdkOverlayOrigin\", \"\", 2, \"position\", \"relative\", \"width\", \"400px\", 3, \"click\"], [\"trigger\", \"cdkOverlayOrigin\"], [1, \"pi\", \"pi-shopping-bag\", \"busket\"], [\"position\", \"top right\", \"status\", \"success\", 3, \"text\"], [\"cdkConnectedOverlay\", \"\", 3, \"cdkConnectedOverlayOrigin\", \"cdkConnectedOverlayOpen\"], [1, \"busket-body\", 2, \"display\", \"flex\", \"flex-direction\", \"column\"], [2, \"margin-right\", \"20px\"], [\"nbButton\", \"\", \"size\", \"small\", \"status\", \"basic\", 1, \"clearBtw\", 3, \"disabled\", \"click\"], [\"size\", \"small\", \"nbButton\", \"\", \"status\", \"primary\", 1, \"orderBtw\", 3, \"disabled\", \"routerLink\", \"click\"], [\"style\", \"padding: 20px;\", 4, \"ngFor\", \"ngForOf\"], [1, \"pi\", \"pi-times\", \"closeBusket\", 3, \"click\"], [2, \"padding\", \"20px\"], [1, \"card-header\"], [1, \"card-body\"], [4, \"ngFor\", \"ngForOf\"], [1, \"deleteProduct\", 3, \"click\"]],\n  template: function BusketComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"a\", 0, 1);\n      i0.ɵɵlistener(\"click\", function BusketComponent_Template_a_click_0_listener() {\n        return ctx.openBusket();\n      });\n      i0.ɵɵtext(2, \" \\u041A\\u043E\\u0440\\u0437\\u0438\\u043D\\u0430 \");\n      i0.ɵɵelement(3, \"i\", 2)(4, \"nb-badge\", 3);\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(5, BusketComponent_ng_template_5_Template, 8, 6, \"ng-template\", 4);\n    }\n    if (rf & 2) {\n      const _r0 = i0.ɵɵreference(1);\n      i0.ɵɵadvance(4);\n      i0.ɵɵpropertyInterpolate(\"text\", ctx.products.length);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"cdkConnectedOverlayOrigin\", _r0)(\"cdkConnectedOverlayOpen\", ctx.isOpen);\n    }\n  },\n  dependencies: [i3.RouterLink, i4.NgForOf, i5.CdkConnectedOverlay, i5.CdkOverlayOrigin, i6.NbBadgeComponent, i6.NbCardComponent, i6.NbCardBodyComponent, i6.NbCardFooterComponent, i6.NbCardHeaderComponent, i6.NbButtonComponent, i4.KeyValuePipe],\n  styles: [\".busket-body[_ngcontent-%COMP%] {\\r\\n    width: 500px;\\r\\n    overflow: auto;\\r\\n    height: 650px;\\r\\n    border: solid 1px #ccc;\\r\\n    border-radius: 5px;\\r\\n    background: #fff;\\r\\n    text-align: center;\\r\\n    padding: 10px;\\r\\n    margin: 0;\\r\\n}\\r\\n\\r\\n.busket-body[_ngcontent-%COMP%]    > div[_ngcontent-%COMP%]  {\\r\\n    list-style-type: none;\\r\\n    border-bottom: solid 1px #8b8b8b;\\r\\n    padding: 18px 0;\\r\\n}\\r\\n  \\r\\n.busket-body[_ngcontent-%COMP%]    > div[_ngcontent-%COMP%]:last-child {\\r\\n    border-bottom: none;\\r\\n}\\r\\n\\r\\n.busket[_ngcontent-%COMP%] {\\r\\n    margin-right: 25px;\\r\\n}\\r\\n\\r\\n.deleteProduct[_ngcontent-%COMP%] {\\r\\n    text-decoration: none;\\r\\n    cursor: pointer;\\r\\n}\\r\\n\\r\\n.line[_ngcontent-%COMP%] { \\r\\n    border-left: 2px solid #ccc;\\r\\n    margin-left: 20px; \\r\\n    padding-left: 10px;\\r\\n}\\r\\n\\r\\n.closeBusket[_ngcontent-%COMP%] {\\r\\n    position: fixed;\\r\\n    margin-left: 450px;\\r\\n}\\r\\n\\r\\n.fixedBtwsColumm[_ngcontent-%COMP%] {\\r\\n    display: flex; \\r\\n    flex-direction: column; \\r\\n    align-items:end; \\r\\n    margin-right: 20px;\\r\\n}\\r\\n\\r\\n.clearBtw[_ngcontent-%COMP%] {\\r\\n    margin-right: 20px;\\r\\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvY29tcG9uZW50cy9idXNrZXQvYnVza2V0LmNvbXBvbmVudC5jc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7SUFDSSxZQUFZO0lBQ1osY0FBYztJQUNkLGFBQWE7SUFDYixzQkFBc0I7SUFDdEIsa0JBQWtCO0lBQ2xCLGdCQUFnQjtJQUNoQixrQkFBa0I7SUFDbEIsYUFBYTtJQUNiLFNBQVM7QUFDYjs7QUFFQTtJQUNJLHFCQUFxQjtJQUNyQixnQ0FBZ0M7SUFDaEMsZUFBZTtBQUNuQjs7QUFFQTtJQUNJLG1CQUFtQjtBQUN2Qjs7QUFFQTtJQUNJLGtCQUFrQjtBQUN0Qjs7QUFFQTtJQUNJLHFCQUFxQjtJQUNyQixlQUFlO0FBQ25COztBQUVBO0lBQ0ksMkJBQTJCO0lBQzNCLGlCQUFpQjtJQUNqQixrQkFBa0I7QUFDdEI7O0FBRUE7SUFDSSxlQUFlO0lBQ2Ysa0JBQWtCO0FBQ3RCOztBQUVBO0lBQ0ksYUFBYTtJQUNiLHNCQUFzQjtJQUN0QixlQUFlO0lBQ2Ysa0JBQWtCO0FBQ3RCOztBQUVBO0lBQ0ksa0JBQWtCO0FBQ3RCIiwic291cmNlc0NvbnRlbnQiOlsiLmJ1c2tldC1ib2R5IHtcclxuICAgIHdpZHRoOiA1MDBweDtcclxuICAgIG92ZXJmbG93OiBhdXRvO1xyXG4gICAgaGVpZ2h0OiA2NTBweDtcclxuICAgIGJvcmRlcjogc29saWQgMXB4ICNjY2M7XHJcbiAgICBib3JkZXItcmFkaXVzOiA1cHg7XHJcbiAgICBiYWNrZ3JvdW5kOiAjZmZmO1xyXG4gICAgdGV4dC1hbGlnbjogY2VudGVyO1xyXG4gICAgcGFkZGluZzogMTBweDtcclxuICAgIG1hcmdpbjogMDtcclxufVxyXG5cclxuLmJ1c2tldC1ib2R5ID4gZGl2ICB7XHJcbiAgICBsaXN0LXN0eWxlLXR5cGU6IG5vbmU7XHJcbiAgICBib3JkZXItYm90dG9tOiBzb2xpZCAxcHggIzhiOGI4YjtcclxuICAgIHBhZGRpbmc6IDE4cHggMDtcclxufVxyXG4gIFxyXG4uYnVza2V0LWJvZHkgPiBkaXY6bGFzdC1jaGlsZCB7XHJcbiAgICBib3JkZXItYm90dG9tOiBub25lO1xyXG59XHJcblxyXG4uYnVza2V0IHtcclxuICAgIG1hcmdpbi1yaWdodDogMjVweDtcclxufVxyXG5cclxuLmRlbGV0ZVByb2R1Y3Qge1xyXG4gICAgdGV4dC1kZWNvcmF0aW9uOiBub25lO1xyXG4gICAgY3Vyc29yOiBwb2ludGVyO1xyXG59XHJcblxyXG4ubGluZSB7IFxyXG4gICAgYm9yZGVyLWxlZnQ6IDJweCBzb2xpZCAjY2NjO1xyXG4gICAgbWFyZ2luLWxlZnQ6IDIwcHg7IFxyXG4gICAgcGFkZGluZy1sZWZ0OiAxMHB4O1xyXG59XHJcblxyXG4uY2xvc2VCdXNrZXQge1xyXG4gICAgcG9zaXRpb246IGZpeGVkO1xyXG4gICAgbWFyZ2luLWxlZnQ6IDQ1MHB4O1xyXG59XHJcblxyXG4uZml4ZWRCdHdzQ29sdW1tIHtcclxuICAgIGRpc3BsYXk6IGZsZXg7IFxyXG4gICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsgXHJcbiAgICBhbGlnbi1pdGVtczplbmQ7IFxyXG4gICAgbWFyZ2luLXJpZ2h0OiAyMHB4O1xyXG59XHJcblxyXG4uY2xlYXJCdHcge1xyXG4gICAgbWFyZ2luLXJpZ2h0OiAyMHB4O1xyXG59Il0sInNvdXJjZVJvb3QiOiIifQ== */\"]\n});","map":{"version":3,"mappings":"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","names":["Subject","takeUntil","SessionStorageConstanst","i0","BusketComponent","constructor","sessionStorageService","productsService","generateUUID","ngOnDestroy","componentDestroyed$","next","complete","ngOnInit","products","getItemByKey","Busket","bucketChanged","pipe","subscribe","console","log","getFormattedProperty","prop","openBusket","isOpen","clearBusket","setItemInJSON","onDeleteProduct","id","filter","x","d","Date","getTime","d2","performance","now","replace","c","r","Math","random","floor","toString","selectors","decls","vars","consts","template","ctx"],"sourceRoot":"","sources":["C:\\Users\\Maksym\\Documents\\GitHub\\backend\\MarketTest\\Test\\ClientApp\\src\\app\\components\\busket\\busket.component.ts","C:\\Users\\Maksym\\Documents\\GitHub\\backend\\MarketTest\\Test\\ClientApp\\src\\app\\components\\busket\\busket.component.html"],"sourcesContent":["import { Component, OnDestroy, OnInit } from \"@angular/core\";\r\nimport { Subject, takeUntil } from \"rxjs\";\r\nimport { SessionStorageConstanst } from \"src/app/shared/constanst/session-storage-constans\";\r\nimport { Product } from \"src/app/shared/models/product\";\r\nimport { ProductsService } from \"src/app/shared/services/products-service\";\r\nimport { SessionStorageService } from \"src/app/shared/services/session-storage-service\";\r\n\r\n\r\n@Component({\r\n    selector: 'app-busket',\r\n    templateUrl: './busket.component.html',\r\n    styleUrls: ['./busket.component.css']\r\n  })\r\n\r\n  export class BusketComponent implements OnInit, OnDestroy {\r\n    isOpen = false;\r\n    products: Product [] = [];\r\n    componentDestroyed$: Subject<boolean> = new Subject();\r\n    routeOrderLine = `/order/${this.generateUUID()}`;\r\n\r\n    constructor(private sessionStorageService: SessionStorageService,\r\n        private productsService: ProductsService) {\r\n          \r\n    }\r\n\r\n    ngOnDestroy(): void {\r\n        this.componentDestroyed$.next(true);\r\n        this.componentDestroyed$.complete();\r\n    }\r\n\r\n    ngOnInit(): void {\r\n        let products:Product[] = this.sessionStorageService.getItemByKey(SessionStorageConstanst.Busket);\r\n        if (products) {\r\n            this.products = products;\r\n        }\r\n        this.productsService.bucketChanged.pipe(takeUntil(this.componentDestroyed$)).subscribe(() => {\r\n            console.log(\"test1\");\r\n            let products:Product[] = this.sessionStorageService.getItemByKey(SessionStorageConstanst.Busket);\r\n            if (products) {\r\n                this.products = products;\r\n            }\r\n        });\r\n    }\r\n\r\n    getFormattedProperty(prop:any) {\r\n        return this.productsService.getFormattedProperty(prop);\r\n    }\r\n\r\n    openBusket() {\r\n        let products:Product[] = this.sessionStorageService.getItemByKey(SessionStorageConstanst.Busket);\r\n        if (products) {\r\n            this.products = products;\r\n        }\r\n        this.isOpen = !this.isOpen;\r\n    }\r\n\r\n    clearBusket() {\r\n        this.products = [];\r\n        this.sessionStorageService.setItemInJSON(SessionStorageConstanst.Busket, this.products);\r\n    }\r\n\r\n    onDeleteProduct(id: number | undefined) {\r\n        this.products = this.products.filter(x => x.id != id);\r\n        this.sessionStorageService.setItemInJSON(SessionStorageConstanst.Busket, this.products);\r\n    }\r\n\r\n    generateUUID() { \r\n        var d = new Date().getTime();\r\n        var d2 = ((typeof performance !== 'undefined') && performance.now && (performance.now()*1000)) || 0;//Time in microseconds since page-load or 0 if unsupported\r\n        return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\r\n            var r = Math.random() * 16;\r\n            if (d > 0) {\r\n                r = (d + r)%16 | 0;\r\n                d = Math.floor(d/16);\r\n            } else {\r\n                r = (d2 + r)%16 | 0;\r\n                d2 = Math.floor(d2/16);\r\n            }\r\n            return (c === 'x' ? r : (r & 0x3 | 0x8)).toString(16);\r\n        });\r\n    }\r\n\r\n\r\n  }","  <a style=\"position: relative; width: 400px;\" (click)=\"openBusket()\" #trigger=\"cdkOverlayOrigin\" cdkOverlayOrigin >\r\n    Корзина  <i class=\"pi pi-shopping-bag busket\"></i>\r\n    <nb-badge position=\"top right\" status=\"success\" text=\"{{products.length}}\"></nb-badge>\r\n  </a>\r\n  \r\n  <ng-template\r\n    cdkConnectedOverlay\r\n    [cdkConnectedOverlayOrigin]=\"trigger\"\r\n    [cdkConnectedOverlayOpen]=\"isOpen\"\r\n  >\r\n  <div class=\"busket-body\" style=\"display: flex; flex-direction: column;\">\r\n    <div style=\"margin-right: 20px;\">\r\n        <button [disabled]=\"products.length == 0\" (click)=\"clearBusket()\" class=\"clearBtw\" nbButton size=\"small\" status=\"basic\">Очистить корзину</button>\r\n        <button (click)=\"isOpen = false\" size=\"small\" [disabled]=\"products.length == 0\" [routerLink]=\"[routeOrderLine]\" class=\"orderBtw\" nbButton status=\"primary\">Оформить заказ</button>\r\n    </div>\r\n      <div style=\"padding: 20px;\" *ngFor=\"let product of products\">\r\n        <nb-card>\r\n            <nb-card-header>\r\n                <div class=\"card-header\">\r\n                    <a>\r\n                        {{product.name}}\r\n                    </a>\r\n                    <br>\r\n                    <a>Стоимость: {{product.price}}</a>\r\n                </div>\r\n            </nb-card-header>\r\n            <nb-card-body>\r\n                <div class=\"card-body\">\r\n                  <a *ngFor=\"let prop of product.properties | keyvalue\">\r\n                    <br>\r\n                    {{getFormattedProperty(prop)}}\r\n                  </a>\r\n                </div>\r\n            </nb-card-body>\r\n            <nb-card-footer>\r\n            </nb-card-footer>\r\n          </nb-card>\r\n          <a (click)=\"onDeleteProduct(product.id)\" class=\"deleteProduct\"> Удалить </a>\r\n      </div>\r\n       <i (click)=\"isOpen=false\" class=\"pi pi-times closeBusket\"></i>\r\n  </div>\r\n  </ng-template>"]},"metadata":{},"sourceType":"module","externalDependencies":[]}